<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Flat-Rate Tracker — More</title>
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./app.css">
</head>
<body data-page="more">
  <header class="top">
    <div class="topRow">
      <div style="font-weight:900">More</div>
      <a class="btn" href="./index.html">Back</a>
    </div>
  </header>

  <main class="wrap">

    <div class="muted small" id="statusMsg" style="padding:0 4px;"></div>
    <div id="dataWarning" class="warningBanner" style="display:none; margin:10px 0 0;"></div>

    <section class="card">
      <div class="h">Employee</div>
      <div class="muted">Required to load your saved entries/photos on this device.</div>
      <div class="row" style="margin-top:10px">
        <input
          id="empId"
          inputmode="numeric"
          placeholder="Employee # (required for export/photos)"
          style="flex:1;min-width:180px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.25);color:#e7eefc"
        />
      </div>
      <div class="muted" style="margin-top:8px">
        Tip: enter it once — it saves on this device.
      </div>
    </section>

    <div class="card">
      <h3>Account</h3>

      <input id="authEmail" type="email" placeholder="Email" class="input" />
      <input id="authPassword" type="password" placeholder="Password" class="input" />

      <div class="row" style="gap:10px; margin-top:10px;">
        <button id="authSignUp" class="btn">Sign Up</button>
        <button id="authSignIn" class="btn primary">Sign In</button>
      </div>

      <div class="row" style="gap:10px; margin-top:10px;">
        <button id="authReset" class="btn">Forgot Password</button>
        <button id="authSignOut" class="btn danger">Sign Out</button>
      </div>

      <div id="authStatus" class="muted" style="margin-top:10px;"></div>
    </div>

    <section class="card">
      <div class="h">Payroll Compare (This Week)</div>
      <div class="muted">Set what payroll flagged so the main page can show the difference.</div>
      <div class="row" style="margin-top:10px">
        <input id="flaggedHours" inputmode="decimal" type="number" step="0.1" placeholder="e.g., 35.0"
               style="flex:1;min-width:180px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.25);color:#e7eefc" />
        <button class="btn primary" id="saveFlaggedBtn">Save Flagged Hours</button>
      </div>
    </section>

    <section class="card">
      <div class="h">Export</div>
      <div class="row">
        <button class="btn" type="button" id="exportCsvBtn">Export CSV</button>
        <button class="btn" type="button" id="exportJsonBtn">Export JSON</button>
        <button class="btn" type="button" id="repairBtn">Repair / Reindex Data</button>
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn" type="button" id="refreshBtn">Refresh Totals</button>
      </div>
    </section>

    <section class="card">
      <div class="h">Review Work</div>
      <div class="muted">Search + filter your saved entries on this device.</div>

      <div class="row" style="margin-top:10px">
        <select id="reviewRange" class="btn" style="flex:1;min-width:160px">
          <option value="week">This Week</option>
          <option value="lastweek">Last Week</option>
          <option value="month">This Month</option>
          <option value="all">All Time</option>
        </select>

        <select id="reviewGroup" class="btn" style="flex:1;min-width:160px">
          <option value="day">Group by Day</option>
          <option value="dealer">Group by Dealer</option>
          <option value="none">No Group</option>
        </select>
      </div>

      <div class="row" style="margin-top:10px">
        <input id="reviewSearch" placeholder="Search RO/Stock, VIN8, Type, Notes…" style="flex:1;min-width:200px;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.25);color:#e7eefc" />
        <button class="btn" type="button" id="reviewRefreshBtn">Refresh</button>
      </div>

      <div class="muted" id="reviewMeta" style="margin-top:10px"></div>
      <div id="reviewList" class="list" style="margin-top:10px"></div>
    </section>

    <section class="card">
      <div class="h">Saved Photos (Entries)</div>
      <div class="muted">Tap "Load Photos" to avoid iPhone crashes.</div>

      <div class="row" style="margin-top:10px">
        <button class="btn primary" type="button" id="loadPhotosBtn">Load Photos</button>
        <button class="btn" type="button" id="clearGalleryBtn">Clear</button>
        <div class="muted" id="galleryStatus" style="align-self:center"></div>
      </div>

      <div id="photoGallery" class="gallery" style="margin-top:10px"></div>
    </section>

    <div id="photoViewer" class="modalShell" style="display:none;">
      <div class="modalContent" style="max-width:900px; margin:20px auto; padding:0 12px;">
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center; gap:10px;">
            <div class="muted" id="photoMeta"></div>
            <button class="btn" id="closePhotoViewerBtn" type="button">Close</button>
          </div>
          <img id="photoFull" style="width:100%; border-radius:16px; margin-top:10px;" />
          <div class="row" style="margin-top:10px;">
            <a class="btn" id="downloadPhotoBtn" download="proof.jpg">Download</a>
            <button class="btn" id="copyPhotoBtn">Copy Image</button>
          </div>
        </div>
      </div>
    </div>

    <section class="card danger">
      <div class="h">Danger Zone</div>
      <div class="muted">This wipes everything stored on this device for this app.</div>
      <div class="row" style="margin-top:10px">
        <button class="btn" type="button" id="wipeBtn" style="flex:1;background:rgba(255,77,77,.12);border-color:rgba(255,77,77,.3)">Wipe Local Data</button>
        <button class="btn" type="button" id="wipeAllBtn" style="background:rgba(255,77,77,.16);border-color:rgba(255,77,77,.35)">Wipe All Local Data</button>
      </div>
    </section>

    <div id="undoBar" style="display:none; position:fixed; left:12px; right:12px; bottom:12px; z-index:9999;">
      <div class="card" style="display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px;">
        <div class="muted" id="undoText">Deleted.</div>
        <div style="display:flex; gap:10px;">
          <button class="btn" id="undoBtn" type="button">Undo</button>
          <button class="btn" id="undoDismissBtn" type="button">Dismiss</button>
        </div>
      </div>
    </div>

  </main>

  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
  <script>
    window.__SUPABASE_CONFIG__ = {
      url: "https://lfnydhidbwfyfjafazdy.supabase.co",
      anonKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxmbnlkaGlkYndmeWZqYWZhemR5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgzNTk0MDYsImV4cCI6MjA4MzkzNTQwNn0.ES4tEeUgtTrPjYR64SGHDeQJps7dFdTmF7IRUhPZwt4"
    };
  </script>
  <script src="/flat-rate-log/app.3691b2abae.js" defer></script>
</body>
</html>
